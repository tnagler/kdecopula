<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kernel Smoothing for Bivariate Copula Densities • kdecopula</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><meta property="og:title" content="Kernel Smoothing for Bivariate Copula Densities">
<meta property="og:description" content="Provides fast implementations of kernel smoothing techniques for
    bivariate copula densities, in particular density estimation and resampling,
    see Nagler (2018) &lt;doi:10.18637/jss.v084.i07&gt;. ">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">kdecopula</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tnagler/kdecopula">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">
<div id="kdecopula" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#kdecopula" class="anchor"></a>kdecopula</h1></div>

<p>This package provides fast implementations of kernel estimators for the copula density. Due to its several plotting options it is particularly useful for the exploratory analysis of dependence structures. It can be further used for flexible nonparametric estimation of copula densities and resampling.</p>
<p>For detailed documentation, see the <a href="https://arxiv.org/pdf/1603.04229.pdf">package vignette</a> and the <a href="https://tnagler.github.io/kdecopula/reference/index.html">API documentation</a>.</p>
<div id="table-of-contents" class="section level2">
<h2 class="hasAnchor">
<a href="#table-of-contents" class="anchor"></a>Table of contents</h2>
<ul>
<li><a href="#how-to-install">How to install</a></li>
<li><a href="#functions">Functions</a></li>
<li>
<a href="#kdecopula-in-action">kdecopula in action</a>
<ul>
<li><a href="#estimation-of-bivariate-copula-densities">Estimation of bivariate copula densities</a></li>
<li><a href="#plotting-bivariate-copula-densities">Plotting bivariate copula densities</a></li>
<li><a href="#working-with-a-kdecopula-object">Working with a kdecopula object</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
<hr>
</div>
<div id="how-to-install" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-install" class="anchor"></a>How to install</h2>
<p>You can install:</p>
<ul>
<li>
<p>the stable release on CRAN:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"kdecopula"</span>)</code></pre></div>
</li>
<li>
<p>the latest development version:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"tnagler/kdecopula"</span>)</code></pre></div>
</li>
</ul>
</div>
<div id="functions" class="section level2">
<h2 class="hasAnchor">
<a href="#functions" class="anchor"></a>Functions</h2>
<p>The package provides the following functions:</p>
<ul>
<li><p><code>kdecop</code>: Kernel estimation of a copula density. By default, estimation method and bandwidth are selected automatically. Returns an object of class <code>kdecopula</code>.</p></li>
<li><p><code>dkdecop</code>: Evaluates the density of a <code>kdecopula</code> object.</p></li>
<li><p><code>pkdecop</code>: Evaluates the distribution function of a <code>kdecopula</code> object.</p></li>
<li><p><code>rkdecop</code>: Simulates synthetic data from a <code>kdecopula</code> object.</p></li>
<li>
<p>Methods for class <code>kdecopula</code>:</p>
<ul>
<li><p><code>plot</code>, <code>contour</code>: Surface and contour plots of the density estimate.</p></li>
<li><p><code>print</code>, <code>summary</code>: Displays further information about the density estimate.</p></li>
<li><p><code>logLik</code>, <code>AIC</code>, <code>BIC</code>: Extracts fit statistics.</p></li>
</ul>
</li>
</ul>
<p>See the <a href="https://cran.r-project.org/web/packages/kdecopula/kdecopula.pdf">package documentation</a> for more details on arguments and options.</p>
<hr>
</div>
<div id="kdecopula-in-action" class="section level2">
<h2 class="hasAnchor">
<a href="#kdecopula-in-action" class="anchor"></a>kdecopula in action</h2>
<p>Below, we demonstrate the main capabilities of the <code>kdecopula</code> package. All user-level functions will be introduced with small examples.</p>
<p>Let’s consider some variables of the <em>Wiscon diagnostic breast cancer</em> data included in this package. The data are transformed to pseudo-observations of the copula by the empirical probability integral/rank transform:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(kdecopula)
<span class="kw">data</span>(wdbc)  <span class="co"># load data</span>
u &lt;-<span class="st"> </span><span class="kw">apply</span>(wdbc[, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">8</span>)], <span class="dv">2</span>, rank) <span class="op">/</span><span class="st"> </span>(<span class="kw">nrow</span>(wdbc) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)  <span class="co"># empirical PIT</span>
<span class="kw">plot</span>(u)  <span class="co"># scatter plot</span></code></pre></div>
<p><img src="inst/README-unnamed-chunk-3-1.png" width="384"></p>
<p>We see that the data are slightly asymmetric w.r.t. both diagonals. Common parametric copula models are usually not flexible enough to reflect this. Let’s see how a kernel estimator does.</p>
<div id="estimation-of-bivariate-copula-densities" class="section level4">
<h4 class="hasAnchor">
<a href="#estimation-of-bivariate-copula-densities" class="anchor"></a>Estimation of bivariate copula densities</h4>
<p>We start by estimating the copula density with the <code>kdecop</code> function. There is a number of options for the smoothing parameterization, estimation method and evaluation grid, but it is only required to provide a data-matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kde.fit &lt;-<span class="st"> </span><span class="kw"><a href="reference/kdecop.html">kdecop</a></span>(u)  <span class="co"># kernel estimation (bandwidth selected automatically)</span>
<span class="kw">summary</span>(kde.fit)
<span class="co">#&gt; Kernel copula density estimate (tau = 0.47)</span>
<span class="co">#&gt; ------------------------------</span>
<span class="co">#&gt; Variables:    mean radius -- mean concavity </span>
<span class="co">#&gt; Observations: 569 </span>
<span class="co">#&gt; Method:       Transformation local likelihood, log-quadratic (nearest-neighbor, 'TLL2nn') </span>
<span class="co">#&gt; Bandwidth:    alpha = 0.3519647</span>
<span class="co">#&gt;               B = matrix(c(0.71, 0.7, -0.7, 0.71), 2, 2)</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; logLik: 201.22    AIC: -367.97    cAIC: -366.83    BIC: -293.11 </span>
<span class="co">#&gt; Effective number of parameters: 17.23</span></code></pre></div>
<p>The output of the function <code>kdecop</code> is an object of class <code>kdecopula</code> that contains all information collected during the estimation process and summary statistics such as <em>AIC</em> or the <em>effective number of parameters/degrees of freedom</em>. These can also be accessed directly, e.g.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">logLik</span>(kde.fit)
<span class="co">#&gt; 'log Lik.' 201.2196 (df=17.23373)</span>
<span class="kw">AIC</span>(kde.fit)
<span class="co">#&gt; [1] -367.9718</span></code></pre></div>
</div>
<div id="plotting-bivariate-copula-densities" class="section level4">
<h4 class="hasAnchor">
<a href="#plotting-bivariate-copula-densities" class="anchor"></a>Plotting bivariate copula densities</h4>
<p>The most interesting part for most people is probably to make exploratory plots. The class <code>kdecopula</code> has its own generic for plotting. In general, there are two possible types of plots: <em>contour</em> and <em>surface</em> (or perspective) plots. Additionally, the <code>margins</code> argument allows to choose between plots of the original copula density and a meta-copula density with standard normal margins (default for <code>type = contour</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(kde.fit)</code></pre></div>
<p><img src="inst/README-unnamed-chunk-6-1.png" width="384"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">contour</span>(kde.fit)</code></pre></div>
<p><img src="inst/README-unnamed-chunk-7-1.png" width="384"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">contour</span>(kde.fit, <span class="dt">margins =</span> <span class="st">"unif"</span>)</code></pre></div>
<p><img src="inst/README-unnamed-chunk-8-1.png" width="384"></p>
<p>You can also pass further arguments to the <code>...</code> argument to refine the aesthetics. The arguments are forwaded to<br><code><a href="http://www.rdocumentation.org/packages/lattice/topics/cloud">lattice::wireframe</a></code> or <code><a href="http://www.rdocumentation.org/packages/graphics/topics/contour">graphics::contour</a></code>, respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(kde.fit, 
     <span class="dt">zlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),  <span class="co"># z-axis limits</span>
     <span class="dt">screen =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="op">-</span><span class="dv">75</span>, <span class="dt">z =</span> <span class="dv">45</span>),  <span class="co"># rotate screen</span>
     <span class="dt">xlab =</span> <span class="kw">list</span>(<span class="dt">rot =</span> <span class="dv">25</span>),  <span class="co"># labels can be rotated as well</span>
     <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="dt">label =</span> <span class="st">"other label"</span>, <span class="dt">rot =</span> <span class="op">-</span><span class="dv">25</span>))  </code></pre></div>
<p><img src="inst/README-unnamed-chunk-9-1.png" width="384"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">contour</span>(kde.fit, <span class="dt">col =</span> <span class="kw">terrain.colors</span>(<span class="dv">30</span>), <span class="dt">levels =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">0.3</span>, <span class="dt">by =</span> <span class="fl">0.01</span>))</code></pre></div>
<p><img src="inst/README-unnamed-chunk-10-1.png" width="384"></p>
</div>
<div id="working-with-a-kdecopula-object" class="section level4">
<h4 class="hasAnchor">
<a href="#working-with-a-kdecopula-object" class="anchor"></a>Working with a <code>kdecopula</code> object</h4>
<p>The density and <em>cdf</em> can be computed easily:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/dkdecop.html">dkdecop</a></span>(<span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>), kde.fit)  <span class="co"># estimated copula density</span>
<span class="co">#&gt; [1] 1.691764</span>
<span class="kw"><a href="http://www.rdocumentation.org/packages/kdecopula/topics/dkdecop">pkdecop</a></span>(<span class="kw">cbind</span>(<span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>), <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>)), kde.fit) <span class="co"># corresponding copula cdf</span>
<span class="co">#&gt; [1] 0.0327257 0.8505370</span></code></pre></div>
<p>Furthermore, we can simulate synthetic data from the estimated density:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">unew &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/kdecopula/topics/dkdecop">rkdecop</a></span>(<span class="dv">655</span>, kde.fit)
<span class="kw">plot</span>(unew)</code></pre></div>
<p><img src="inst/README-unnamed-chunk-12-1.png" width="384"></p>
<p>We see that the asymmetries observed in the data are adequately reflected by the estimated model.</p>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Gijbels, I. and Mielniczuk, J. (1990). Estimating the density of a copula function. <em>Communications in Statistics - Theory and Methods</em>, 19(2):445-464.</p>
<p>Charpentier, A., Fermanian, J.-D., and Scaillet, O. (2006). The estimation of copulas: Theory and practice. In Rank, J., editor, Copulas: From theory to application in finance. Risk Books.</p>
<p>Geenens, G., Charpentier, A., and Paindaveine, D. (2014). Probit transformation for nonparametric kernel estimation of the copula density. <a href="arxiv.org/abs/1404.4414"><em>arXiv:1404.4414 (stat.ME)</em></a>.</p>
<p>Nagler, T. (2014). Kernel Methods for Vine Copula Estimation. <a href="https://mediatum.ub.tum.de/node?id=1231221"><em>Master’s Thesis, Technische Universität München</em></a></p>
<p>Wen, K. and Wu, X. (2015). Transformation-Kernel Estimation of the Copula Density, Working paper, <a href="http://agecon2.tamu.edu/people/faculty/wu-ximing/agecon2/public/copula.pdf">preprint</a></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cran.r-project.org/package=kdecopula">https://​cran.r-project.org/​package=kdecopula</a>
</li>
<li>Browse source code at <br><a href="https://github.com/tnagler/kdecopula">https://​github.com/​tnagler/​kdecopula</a>
</li>
<li>Report a bug at <br><a href="https://github.com/tnagler/kdecopula/issues">https://​github.com/​tnagler/​kdecopula/​issues</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></p>
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing kdecopula</a></li>
</ul>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Thomas Nagler <br><small class="roles"> Author, maintainer </small> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/tnagler/kdecopula"><img src="https://travis-ci.org/tnagler/kdecopula.svg?branch=master" alt="Build status Linux"></a></li>
<li><a href="https://ci.appveyor.com/project/tnagler/kdecopula"><img src="https://ci.appveyor.com/api/projects/status/github/tnagler/kdecopula?branch=master&amp;svg=true" alt="Build status Windows"></a></li>
<li><a href="https://codecov.io/github/tnagler/kdecopula?branch=master"><img src="https://codecov.io/github/tnagler/kdecopula/coverage.svg?branch=master" alt="codecov.io"></a></li>
<li><a href="https://cran.r-project.org/package=kdecopula"><img src="http://www.r-pkg.org/badges/version/kdecopula" alt="CRAN version"></a></li>
<li><a href="https://cran.r-project.org/package=kdecopula"><img src="http://cranlogs.r-pkg.org/badges/kdecopula" alt="CRAN downloads"></a></li>
<li><a href="http://www.gnu.org/licenses/gpl-3.0"><img src="https://img.shields.io/badge/License-GPL%20v3-blue.svg" alt="License: GPL v3"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Thomas Nagler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
